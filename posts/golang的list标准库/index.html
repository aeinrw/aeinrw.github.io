<!DOCTYPE html>
<html lang="zh-CN"><head>
    <title>golang标准库(一): container/list</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="在golang的标准库中, 封装了双向链表list, 在其源码中没有多余的依赖, 很容易读懂. 结构体定义 1//链表元素 2type Element struct { 3 next, prev *Element 4 list *List 5 Value interface{}">
    <meta name="author" content="">


    <link rel="apple-touch-icon" href="https://blog.aeinrw.com/image/apple-touch-icon.png">
    <link rel="icon" href="https://blog.aeinrw.com/image/favicon.ico">

    <link rel="stylesheet" href="https://at.alicdn.com/t/font_1907205_qcnyqfdpzc.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
    <link rel="stylesheet" href="https://blog.aeinrw.com/css/style.css">
    <link rel="stylesheet" href="https://blog.aeinrw.com/css/custom.css">
    <link rel="stylesheet" href="https://blog.aeinrw.com/css/highlight.css">


    <meta name="generator" content="Hugo 0.72.0" />

    <script>
        function setTheme() {
            const now = (new Date()).getHours();
            const prev = Number(localStorage.getItem('oldHour'));

            if (prev !== now) {
                localStorage.setItem('oldHour', now);
                if (now > 7 && now < 18) {
                    localStorage.setItem("isDark", "false");
                    document.body.classList.remove('dark');
                } else {
                    localStorage.setItem("isDark", "true");
                    document.body.classList.add('dark');
                }
            } else {
                if (localStorage.getItem('isDark') == "true") {
                    document.body.classList.add('dark');
                } else {
                    document.body.classList.remove('dark');
                }
            }
        }
        function switchTheme() {
            if (localStorage.getItem('isDark') == "true") {
                localStorage.setItem('isDark', "false");
                document.body.classList.remove('dark');
            } else {
                localStorage.setItem('isDark', "true");
                document.body.classList.add('dark');
            }
        }
    </script>
</head><body class="single"><script>
    setTheme();
</script>
<header class="header">
    <nav class="nav">
        <h1 class="logo"><a href="https://blog.aeinrw.com/">aeinrw</a></h1>
        <ul class="menu">
            <li>
                <a href="/posts/"><i class="iconfont icon-timeline menuicon"></i></a>
            </li>
            <li>
                <a href="/tags/"><i class="iconfont icon-tags menuicon"></i></a>
            </li>
            <li>
                <a href="/categories/"><i class="iconfont icon-categories menuicon"></i></a>
            </li>
            <li>
                <a href="javascript:switchTheme%28%29"><i class="iconfont icon-adjust menuicon"></i></a>
            </li>
        </ul>
    </nav>
</header><main class="main">

<article class="post-single">
    <header class="post-header">
        <h1 class="post-title">golang标准库(一): container/list</h1>
        <div class="post-meta">July 01, 2020</div>
        <ul class="post-tags">
            <li><a href="https://blog.aeinrw.com/tags/golang">golang</a></li>
            <li><a href="https://blog.aeinrw.com/tags/%E6%A0%87%E5%87%86%E5%BA%93">标准库</a></li>
        </ul>
    </header>
    <div class="post-content"><p>在golang的标准库中, 封装了双向链表<code>list</code>, 在其源码中没有多余的依赖, 很容易读懂.</p>
<h1 id="结构体定义">结构体定义</h1>
<div class="highlight"><pre class="chroma"><code class="language-golang" data-lang="golang"><span class="ln"> 1</span><span class="c1">//链表元素
</span><span class="ln"> 2</span><span class="c1"></span><span class="kd">type</span> <span class="nx">Element</span> <span class="kd">struct</span> <span class="p">{</span>
<span class="ln"> 3</span>    <span class="nx">next</span><span class="p">,</span> <span class="nx">prev</span> <span class="o">*</span><span class="nx">Element</span>
<span class="ln"> 4</span>    <span class="nx">list</span> <span class="o">*</span><span class="nx">List</span>
<span class="ln"> 5</span>    <span class="nx">Value</span> <span class="kd">interface</span><span class="p">{}</span>
<span class="ln"> 6</span><span class="p">}</span>
<span class="ln"> 7</span>
<span class="ln"> 8</span><span class="c1">//链表
</span><span class="ln"> 9</span><span class="c1"></span><span class="kd">type</span> <span class="nx">List</span> <span class="kd">struct</span> <span class="p">{</span>
<span class="ln">10</span>    <span class="nx">root</span> <span class="nx">Element</span>
<span class="ln">11</span>    <span class="nx">len</span> <span class="kt">int</span>
<span class="ln">12</span><span class="p">}</span>
</code></pre></div><p>链表元素<code>Element</code>只有一个可导出元素<code>Value</code>, 是个空接口, 可以存放任意值. 其余元素为私有的, 供内部使用.</p>
<p>链表<code>List</code>由根节点<code>root</code>和链表长度<code>len</code>组成, 根节点就相当于是头节点, 值为<code>nil</code>, 方便元素的插入和删除, 不计入链表长度中.</p>
<h1 id="方法">方法</h1>
<div class="highlight"><pre class="chroma"><code class="language-golang" data-lang="golang"><span class="ln"> 1</span><span class="kd">func</span> <span class="nf">New</span><span class="p">()</span> <span class="o">*</span><span class="nx">List</span>
<span class="ln"> 2</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">Init</span><span class="p">()</span> <span class="o">*</span><span class="nx">List</span>
<span class="ln"> 3</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">Len</span><span class="p">()</span> <span class="kt">int</span>
<span class="ln"> 4</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">Front</span><span class="p">()</span> <span class="o">*</span><span class="nx">Element</span>
<span class="ln"> 5</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">Back</span><span class="p">()</span> <span class="o">*</span><span class="nx">Element</span>
<span class="ln"> 6</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">PushFront</span><span class="p">(</span><span class="nx">v</span> <span class="kd">interface</span><span class="p">{})</span> <span class="o">*</span><span class="nx">Element</span>
<span class="ln"> 7</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">PushFrontList</span><span class="p">(</span><span class="nx">other</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span>
<span class="ln"> 8</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">PushBack</span><span class="p">(</span><span class="nx">v</span> <span class="kd">interface</span><span class="p">{})</span> <span class="o">*</span><span class="nx">Element</span>
<span class="ln"> 9</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">PushBackList</span><span class="p">(</span><span class="nx">other</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span>
<span class="ln">10</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">InsertBefore</span><span class="p">(</span><span class="nx">v</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">mark</span> <span class="o">*</span><span class="nx">Element</span><span class="p">)</span> <span class="o">*</span><span class="nx">Element</span>
<span class="ln">11</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">InsertAfter</span><span class="p">(</span><span class="nx">v</span> <span class="kd">interface</span><span class="p">{},</span> <span class="nx">mark</span> <span class="o">*</span><span class="nx">Element</span><span class="p">)</span> <span class="o">*</span><span class="nx">Element</span>
<span class="ln">12</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">MoveToFront</span><span class="p">(</span><span class="nx">e</span> <span class="o">*</span><span class="nx">Element</span><span class="p">)</span>
<span class="ln">13</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">MoveToBack</span><span class="p">(</span><span class="nx">e</span> <span class="o">*</span><span class="nx">Element</span><span class="p">)</span>
<span class="ln">14</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">MoveBefore</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">mark</span> <span class="o">*</span><span class="nx">Element</span><span class="p">)</span>
<span class="ln">15</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">MoveAfter</span><span class="p">(</span><span class="nx">e</span><span class="p">,</span> <span class="nx">mark</span> <span class="o">*</span><span class="nx">Element</span><span class="p">)</span>
<span class="ln">16</span><span class="kd">func</span> <span class="p">(</span><span class="nx">l</span> <span class="o">*</span><span class="nx">List</span><span class="p">)</span> <span class="nf">Remove</span><span class="p">(</span><span class="nx">e</span> <span class="o">*</span><span class="nx">Element</span><span class="p">)</span> <span class="kd">interface</span><span class="p">{}</span>
</code></pre></div><p>链表通过<code>list.New()</code>进行生成, 返回链表指针, 函数内部调用了<code>Init()</code>, 返回了<code>new(List).Init()</code>. 而结构体方法<code>Init()</code>初始化了链表, 使头节点<code>root</code>的<code>next</code>和<code>prev</code>指向自身, 并赋<code>len</code>为0.</p>
<p><code>l.Front()</code>和<code>l.Back()</code>返回链表的首节点(不是头节点)和尾节点.</p>
<p>通过<code>l.PushFront()</code>和<code>l.PushBack()</code>向链表的头和尾插入新节点, 可以当作栈和队列使用.</p>
<p>其他方法都见名知意.</p>
<h1 id="遍历方法">遍历方法</h1>
<div class="highlight"><pre class="chroma"><code class="language-golang" data-lang="golang"><span class="ln">1</span><span class="k">for</span> <span class="nx">e</span> <span class="o">:=</span> <span class="nx">l</span><span class="p">.</span><span class="nf">Front</span><span class="p">()</span> <span class="p">;</span> <span class="nx">e</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">;</span> <span class="nx">e</span> <span class="p">=</span> <span class="nx">e</span><span class="p">.</span><span class="nf">Next</span><span class="p">()</span> <span class="p">{</span>
<span class="ln">2</span>    <span class="o">...</span>
<span class="ln">3</span><span class="p">}</span>
</code></pre></div><p>因为头节点的<code>Value</code>为<code>nil</code>, 可以通过它进行循环结束的判断.</p>
<div class="highlight"><pre class="chroma"><code class="language-golang" data-lang="golang"><span class="ln">1</span><span class="k">for</span> <span class="nx">i</span><span class="p">,</span><span class="nx">e</span> <span class="o">:=</span> <span class="nx">l</span><span class="p">.</span><span class="nf">Len</span><span class="p">(),</span><span class="nx">l</span><span class="p">.</span><span class="nf">Front</span><span class="p">()</span> <span class="p">;</span> <span class="nx">i</span><span class="p">&gt;</span><span class="mi">0</span> <span class="p">;</span> <span class="nx">i</span><span class="p">,</span><span class="nx">e</span> <span class="p">=</span> <span class="nx">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="nx">e</span><span class="p">.</span><span class="nf">Next</span><span class="p">()</span> <span class="p">{</span>
<span class="ln">2</span>    <span class="o">...</span>
<span class="ln">3</span><span class="p">}</span>
</code></pre></div><p>这种写法是源码中的写法, 如果链表中存在<code>nil</code>元素, 可以通过这种写法进行遍历.</p>
</div>
    <hr>
    
<span id="/posts/golang%E7%9A%84list%E6%A0%87%E5%87%86%E5%BA%93/" class="leancloud_visitors" data-flag-title="golang标准库(一): container/list">
    <span class="post-meta-item-text">总访问量 </span>
    <span class="leancloud-visitors-count">1000000</span>
</span>
<div id="vcomments"></div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='//unpkg.com/valine/dist/Valine.min.js'></script>
<script type="text/javascript">
    new Valine({
        el: '#vcomments',
        appId: 'nU6nQElcmyWpdE0G8diSQQ4H-gzGzoHsz',
        appKey: 'QipPB7dfjJ3qBSEaQ9w9Frff',
        notify:  false ,
        verify:  false ,
        avatar: 'mm',
        placeholder: '说点什么吧...',
        visitor:  true 
    });
</script>


    
    <script src="https://blog.aeinrw.com/js/highlight.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>
</article>


        </main><footer class="footer">
    
    <div>
        
        
        
        <span><a href="https://github.com/aeinrw"><i class="iconfont icon-github"></i></a></span>
        
        
        
        <span><i class="iconfont icon-anjianfengexian"></i></span>
        
        <span><a href="https://www.weibo.com/6064805995/profile"><i class="iconfont icon-tubiaozhizuo-"></i></a></span>
        
        
        
        <span><i class="iconfont icon-anjianfengexian"></i></span>
        
        <span><a href="mailto:i@aeinrw.com"><i class="iconfont icon-youxiang"></i></a></span>
        
        
        
        <span><i class="iconfont icon-anjianfengexian"></i></span>
        
        <span><a href="https://www.zhihu.com/people/wei-ran-75-78"><i class="iconfont icon-zhihu"></i></a></span>
        
        
    </div>
    <div>
        <span>&copy; 2020 <a href="" ZgotmplZ>aeinrw</a></span>
        <span>&middot;</span>
        <span><a href="http://www.beian.miit.gov.cn/">皖ICP备 20011881号</a>️</span>
        <span>&middot;</span>
        <span>Powered by <a href="https://gohugo.io/" rel="noopener" target="_blank">Hugo️️</a>️</span>
    </div>
    <div>
        <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

        <span>本站总访问量 <span id="busuanzi_value_site_pv"></span> 次&nbsp&nbsp&nbsp</span>
        <span>本站访客数 <span id="busuanzi_value_site_uv"></span> 人次</span>
    </div>
</footer></body>

</html>